### <a name="_b7urdng99y53"></a>**Название задачи:MP-ADR1 MVP открытия депозитов банка "Стандарт" ** 
### <a name="_hjk0fkfyohdk"></a>**Автор: Щербина Семен**
### <a name="_uanumrh8zrui"></a>**Дата: 12.01.2026**
### <a name="_3bfxc9a45514"></a>**Функциональные требования**

На основе функциональных требований (FURPS+, раздел F) описаны следующие Use Case
|**№**|**Действующие лица или системы**|**Use Case**|**Описание**|**Комментарий**|
| :-: | :- | :- | :- | :- |
| UC1 | Пользователь,<br> Интернет-банк | Авторизация | 1.Пользователь вводит номер телефона и пароль<br> 2. При успехе платформа переводит пользователя на страницу с его платежными счетами| В данном UC мы рассматриваем процесс авторизации, для понимания в дальнейшем как пользователь может получать что-то персонализированно и использовать свои счета.<br><br> Регистрация только оффлайн - это первое открытие счета и получение пароля для доступа в интернет-банк|
| UC2 | Пользователь,<br> Интернет-банк,<br>Сервис депозитов| Просмотр страницы депозитов в интернет-банке | 1.Пользователь после авторизации переходит во вкладку - депозиты<br> 2.Платформа интернет-банка должна подгрузить ему актуальные ставки по депозитам и персонализированные лично для него<br>| Для предоставления информации по ставкам депозитов получаются из нового сервиса -  "Микросервис депозитов". Там теперь в БД и будут храниться ставки, которые раннее сотрудники ввели в XLS-файле. Для этого мигрируем данные из файла в БД системы и новые должны поступать сразу туда.<br><br> Для того чтобы можно было отобразить персональные ставки, то один раз в день, с получением данных от ЦБ, отдел кредитования должен сделать предрасчет для всех пользователей с суммами на счетах > N. После предрасчета система АБС должна отправить их в "Микросервис-депозитов" |
| UC3 | Пользователь,<br> Интернет-банк,<br>Телеком-оператор,<br>АБС,<br> Сервис депозитов,<br> Менеджер бэк-офиса депозитов | Подача заявки на открытие депозита в интернет-банке | 1.Пользователь указывает счет и сумму депозита<br> 2.Система телеком-оператора присылает СМС с кодом<br> 3.Пользователь вводит код<br> 4.После заявка отправляет по старому процессу в АБС, менеджер бэк-офиса перепроверяет и согласует её<br> 4.АБС отправляет данные о созданном депозите в "Микросервис депозитов"<br> 5.АБС отправляет данные в смс-шлюз и телеком-оператор отправляет по СМС пользователю подтверждение(или отклонение заявки)| Так как сейчас ставки по депозитам и открытые депозиты ведутся в новом сервисе, то нужно их туда мигрировать из АБС(уже существующие). Теперь вся работа будет вестись сотрудниками также через десктоп-клиент, но вся депозитная логика будет обрабатываться новым сервисом. Это даст возможность горизонтально масштабироваться и снять нагрузку с текущей БД АБС. Доступ к данным депозитов и ставок можно лимитировать и давать разные права разным отделам|
| UC4 | Пользователь,<br> Сайт,<br> Сервис депозитов| Просмотр страницы депозитов на сайте| 1.Пользователь заходит на сайте во вкладку - депозиты<br> 2.Сайт должен подгрузить актуальные депозитные ставки| Сайт обращается к новому сервису депозитов и смотрит оттуда общие депозитные ставки|
| UC5 | Пользователь,<br> Сайт,<br> Система кол-центра,<br> Сотрудник кол-центра,<br> Сервис депозитов| Подача заявки на открытие депозита на сайте| 1.Пользователь заполняет на сайте форму на депозит - указывает телефон и ФИО<br> 2.Сайт отправляет оставленную заявку на депозит в систему кол-центра<br> 3.Сотрудник кол-центра через свою систему обращается за данными в Сервис депозитов и смотрит ставки на данного пользователя<br> 4.Сотрудник звонит клиенту и предлагает условия, после чего пользователь может придти в банк и открыть депозит<br> 5.Система кол-центра отправляет запрос на открытие депозита в АБС<br> 6.Сотрудник бэк-офиса подтверждает/отклоняет её<br> 7.Отправляется в сервис депозитов со статусом - неактивный депозит<br> 8.После прихода и подтверждения депозита пользователем, сотрудник фронт-офиса в АБС подтверждает депозит<br> 9.Система АБС отправляет подтверждение депозита в Сервис депозитов чтобы он поменял статус на - активный депозит| Здесь можно подчеркнуть то, что мы после звонка и предложения условий должны зафиксировать этот депозит на этих условиях, чтобы пользователь пришел лично и не был шокирован другими ставками. Получается мы создаем отложенный депозит, если пользователь не придет в течение указанного срока для подтверждения, то он перейдет в статус - удален.|
### <a name="_u8xz25hbrgql"></a>**Нефункциональные требования**
На основе нефункциональных требований и ограничений FURPS+(разделы - R, P, +)

|**№**|**Требование**|**Комментарий**|
| :-: | :- | :- |
|1| Сервисы должен работать круглосуточно 24/7 | Это ограничение пояснительное, что сервисы не останавливаются|
|2| Сервисы должны быть доступны в 99,9% случаях| Это ограничение описывает SLA сервисов|
|3| Сервисы интернет-банка должны быть доступны в случае сбоя одного ЦОДа и выдерживать требуемую нагрузку| В данной задаче мы это не конкретизируем, это диаграмма деплоя|
|4| Время отклика по всем операциям должен быть не более 300 мс для 95% запросов| Нужно учесть|
|5| Время загрузки справочных данных для платежей не должно превышать 500 мс| Это ограничение к уже существующим справочным материалам, косвенно только можем повлиять разгрузкой монолита от депозитов|
|6| Система должна поддерживать равномерное распределение запросов между серверами и ЦОДами при увеличении нагрузки до N одновременных пользователей| это ограничение к балансировке трафика и ЦОД, это DEVOPS-задача|
|7| Передача чувствительных данных с сайта должна осуществляться с использованием защищённого канала (например, TLS) | Нужно учесть|
|8| Реализация бизнес-логики отправки СМС не должна требовать доработки ядра системы подрядчиком| Нужно учесть |
|9| Передача чувствительных данных с интернет-банка должна осуществляться с использованием защищённого канала (например, TLS)| Нужно учесть |
|10| При использовании доработках использовать БД - MS SQL/Oracle| Тогда и будем использовать Oracle в данном варианте|
|11| При использовании очередей, выбираем Kafka| В данном варианте очереди не будут выбраны, ограничение на будущее|
|12| В связи с риском перегрузки БД в АБС необходимо научиться горизонтально масштабироваться| Нужно учесть |
### <a name="_qmphm5d6rvi3"></a>**Решение**
[C4-context-url](https://www.plantuml.com/plantuml/uml/RP9FRzD04CNl-HI3LObK8l654rAbGk16eMh8kHgl9ud5_Z4xioryUsRzXonkR-Ct-tvwy-HR5eoId5szwRongIKuY_JyeQuZFczFdPnJavYY2Lx8ozO4L_SMVVPiM5hRDVNk_UO-IuUxhxL35eegFUxKWPsdkEqpVtLFaODVPzWxgFQ2liKey0dzJpYeMAcgImQ49clyHqckkbwjziEqpkeull1_josCAwLSjSGctbGVhGMJOYGleFodpX0hhg1zfZvm9ugRffUGR_GCxRHqwF54BlEMuHw__9QrGMjtkesaH1KeUhImKnL6USPVbovs_8CicJ2STRVVJ5-Nnwi7ibDlPGTN5XkoDzKXboPd6fPl6VW_N-aeRhxOz-HR1cqJ8XdgdXJMeY04Fny-RkSM8ihGun9UtB5WH_gLY1KZ0LWLo5SwOjOs1p7VndFWeiNN0pyiOowJBIbboZBPH3Y62A4dt_dJZ7erJ4vv0Go_jn4Umm-GEKSu7YdEGOfQ2i8Y0ZOXoJy_2qhYHJMt-Zev-nS0)<br>
[C4-container-url](http://www.plantuml.com/plantuml/uml/lLRVRzis47xNNy4P1PO2Y_tIlGm8KF_8kWtDwiKUzXXGr4LcGf4QITdDbltlkvD4-wfuNhEkVKd4i_XzttsyE-frYDB7fZBPLzegqnGWDZ7MuRl9nClTkDHnq-HD0A-SZM3ZMBbgKXjfQSzvY8NH-MJ-wdn9eL-ltaug6I9u3DtCSOVK5lou9lmiMu8FpfuHsZTYD9FsNj3p21Vuln0enHQeHkJuq-XbbgqU4AkwcRc6uWzdqSijc2wAczRjKaphUlHI_9bbGkmfptQGOnnV-Wtoe2CWoOi8QcClHiiVbfDha2gExmA52mZANupQK13HYRW1WS_QsI3SBIrRdVi5OWiFmJLUWK398e0j0eP-Ro0S873B5ZpcmNLLBjS6EcdlhC6O82EOlF7FbslnlPSLx9o_5w_6tpAHwrxBrq7KhPlIj6vfMw9aXKP5SUkygAIL9Gk6LkTjWpe7WcIkKCgqYQwIKIinwz4wbvck1PXwemTQY1krb81GA2Mqcre5zm0ruNXGpXUTTrxQa8n5FKdSK9AInip1HW-eR8uBqQsUQlf9RkNZglP4D7CkCdKhT5yhQBMGIg6GjJ5HFkKBLNWZ8-pa0_AjhbRd_QhdOw1J4HYijX4yvaFiEsmKp4d0UupHgKGmc7dLMp9WBA1sGKUaMtHFpqfjAYpic19st5GReaVlqimuyI8_5E1Yzc49YeMCCfU1jyhLIgn-USkeqpijg-isf_ehy3SHelEo1ABcj5HcBU5qDZz6z0vzDF11ZaMYQgsbXgeGJ1XNQfKwCNb0xnMeHzJUAIWQ3s6e87bEAfBhnvGiNOYb1qnxe8ObJaaEtUuhkgwDLh8jySwZ6Yo-oi_ahopRwxgvV1-f_jPTjVJrrw-Urj_biBfu4T0K8Yf2g204MP8B0wv3R-4AwVQ8hC-E4SgYq9WLFHA4K435JqCwkmRJp_GqT5yOcOEvQASwi_OkEFj8jmjkEsnA1VbH-pesjgNtzR3tkfl2pFEkCCcXDCbFQ6BGl5Fsy6yW4ao7IIUU2YCmK2oUn_LysKCcYKdF9y9X9nr9UqspjQ8or5W5MrqqT3FeWcwZ_lPw5Bqt55BEtcfV4NcgKMegcP3JR3vg5HE2Vpun7-Ou7yG9yKUhevP6_z4sLQintRJzqCLS2k3DnhB87vvvw9JKi9O8EncML0nzIjod_JgU8ZiMwc7qZNeuCIBenCCTTFVClvrN-lXGHiF9qyDU_UyD54vr9x--X-Wyrws6tPx2omZXuvgKCtpM0nlCoY_5zBbSIoVEtKi4Ax0qAWvVbvxb9nFViy0na_yHd_SDlozFzr2w1_y1-3M-sLJcRm00) <br>

[c4-context-image](c4-context-image.png)<br>
[c4-container-image](c4-container-image.png)<br>

Решение об отдельном сервисе было принято по ряду причин
- Думаем в сторону масштабирования, цель банка переходить в онлайн-формат со временем, поэтому большой монолит будет мешать, если уже сейчас можно выделить это в отдельный сервис.
- База АБС у нас загружена в том числе из-за того, что вся логика сервиса это PL/SQL процедуры, от этого все операции висят на уровне СУБД и замедляют систему. А наши типы баз умеют только вертикально масштабироваться(в отличие от той же YDB). Поэтому нужно применять шардирование, что требует знаний в этой области. И в принципе ужасно держать всю логику на уровне СУБД.
- Снимаем нагрузку с текущей СУБД, вынося целый продукт в отдельную систему со своей БД. В дальнейшем кредитование может быть вынесено, что облегчит базу АБС.
### <a name="_bjrr7veeh80c"></a>**Альтернативы**
Из альтернативных вариантов есть способ поддержать логику в самой АБС, но при этом мы сталкнемся с рядом недостатков

**Недостатки, ограничения, риски**

- Не сможем выполнять нефункциональное требование с быстрым откликом на создание депозитов, база ужасно загружена, а этим мы ее вообще рискуем положить
- Не сможем в дальнейшем масштабировать отдельно продукты
- Также ставим под вопрос доступность сервиса и его риски падения, не сможем балансировать трафик равномерно